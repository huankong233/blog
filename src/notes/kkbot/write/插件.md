---
title: 插件
author: huan_kong
createTime: 2023/06/30 03:28:04
permalink: /note/kkbot/write/plugin
---

## 加载方式

一共有三种种加载配置插件的方式，支持使用 `await` 来控制异步操作

比如一些插件依赖于某些插件，就可以让那部分先加载

[详见](/note/kkbot/libs/loadPlugin)

## `index.js` 文件示例

需要一个默认暴露一个匿名函数，
在加载插件时会执行这个函数

::: warning
新版本全部改为了静态导入，需要手动import!!
:::

~~~ javascript
import { loadConfig } from '../../libs/loadConfig.js'

export default () => {
  // 加载配置文件
  loadConfig('admin.jsonc', true)
  // 注册事件
  event()
}

import { eventReg } from '../../libs/eventReg.js'

function event() {
  // 一共有三种消息类型，会返回的类型如下
  RegEvent('notice', async context => {
    await notice(context)
  })
  RegEvent('request', async context => {
    await request(context)
  })
  RegEvent('message', async (event, context, tags) => {
    // 事件触发内部会自动检查是否是命令
    if (context.command) {
      if (context.command.name === '入群') {
        await invite(context, context.command.params, 'invite')
      } else if (context.command.name === '加群') {
        await invite(context, context.command.params, 'add')
      } else if (context.command.name === '好友') {
        await friend(context, context.command.params)
      }
    }
  })
}

// 其余处理程序
~~~
