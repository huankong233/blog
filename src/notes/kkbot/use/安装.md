---
title: 安装
author: huan_kong
createTime: 2023/06/30 03:21:06
permalink: /note/kkbot/use/install
---

一共有两种安装模式，一种是直接安装，一种是用 `Docker` 来安装，我推荐是使用 `Docker` 安装

## Docker安装

### 1.准备好需要的工具

需要用到 `git` , `docker` , `docker-composer`

### 2.克隆仓库

~~~ bash
git clone https://github.com/huankong233/kkbot.git
~~~

### 3.部署数据库

数据库:

~~~ yaml
version: "3"
services:
  mysql:
    container_name: mysql
    image: mariadb:10.9
    restart: always
    environment:
      - MYSQL_ROOT_PASSWORD=ROOT密码
      - MYSQL_USER=数据库用户名
      - MYSQL_PASSWORD=数据库密码
  phpmyadmin:
    container_name: phpmyadmin
    image: phpmyadmin/phpmyadmin
    restart: always
    depends_on:
      - mysql
    environment:
      - PMA_ARBITRARY=1
      - PMA_HOST=mysql
      - PMA_PORT=3306
      - PMA_USER=root
      - PMA_PASSWORD=ROOT密码
    volumes:
      - /sessions
    ports:
      - 80:80
~~~

部署完成后打开进入服务器的80端口，就可以看见 `phpmyadmin` 的界面了。

把根目录下的 `kkbot.sql` 导入数据库即可

创建一个新的账户，不要直接用 `Root` 用户

### 4.部署机器人

把路径中的改成你自己设置的路径

kkbot的路径需要是第二步中克隆的位置

~~~ yaml
version: "3"
services:
  go-cqhttp:
    container_name: go-cqhttp
    restart: always
    image: namiya233/go-cqhttp:latest
    volumes:
      - /path/to/kkbot:/kkbot
      - /path/to/go-cqhttp:/data
  kkbot:
    container_name: kkbot
    restart: always
    image: huankong233/kkbot:latest
    volumes:
      - /path/to/kkbot:/kkbot
~~~

### 5.检查配置

如果直接运行会遇到报错

~~~ txt
Error: ENOENT: no such file or directory, open './config/bot.jsonc'
~~~

需要把 `config.default` 文件夹的 `.default` 去掉。

然后进入检查每个配置文件，里面都有写好注释，根据自己的情况修改吧。

## 直接安装

### 1.准备好需要的工具

需要用到 `git` , `nodejs18` , `yarn` , `mysql` , `python3` , `pip3`

### 2.克隆仓库

~~~ bash
git clone https://github.com/huankong233/kkbot.git
~~~

### 3.导入数据库

把根目录下的 `kkbot.sql` 导入数据库即可

创建一个新的账户，不要直接用 `Root` 用户

### 4.下载依赖文件

运行 `npm install yarn -g` 来安装 `yarn` 包管理工具

如果是 `linux` 需要手动修改一下环境变量，自行谷歌搜一下吧

运行 `yarn` 来安装需要的依赖

运行 `pip3 install -r requirements.txt` 来安装需要的依赖

### 5.检查配置

如果直接运行会遇到报错

~~~ txt
Error: ENOENT: no such file or directory, open './config/bot.jsonc'
~~~

需要把 `config.default` 文件夹的 `.default` 去掉。

然后进入检查每个配置文件，里面都有写好注释，根据自己的情况修改吧。

### 6.测试运行

~~~ bash
yarn test
~~~

### 7.运行

如果测试运行正常

~~~ bash
# 测试运行
yarn test
# 后台运行
yarn start
# 退出运行
yarn stop
# 查询运行情况
yarn list
# 进入开发模式(自动重启，一般用户用不到)
yarn dev
~~~
