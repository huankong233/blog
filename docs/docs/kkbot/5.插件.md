---
title: 插件
date: 2023-02-08
---

默认插件文件在 `plugins` 文件夹下
如果需要修改可以在 `src/load/index.js` 中修改 `loadPlugin` 方法

## 编写

一共有三种种加载配置插件的方式

支持使用 `await` 来控制异步操作

比如一些插件依赖于某些插件，就可以让那部分先加载

### 1.加载单个插件

函数名: `loadPlugin`

函数参数：

| 字段          | 类型  | 说明       |
| ------------- | ----- | ---------- |
| `plugin`     | string | 插件文件夹名 |

### 2.加载多个插件

函数名: `loadPlugins`

函数参数：

| 字段          | 类型  | 说明       |
| ------------- | ----- | ---------- |
| `plugin`   | array | 插件文件夹名 |

### 3.加载文件夹内的所有插件

可以实现和本体分离

函数名: `loadPluginDir`

函数参数：

| 字段          | 类型  | 说明       |
| ------------- | ----- | ---------- |
| `path`   | string | 插件文件夹 |

### 4.配置文件示例

需要一个默认暴露一个匿名函数，
在加载插件时会执行这个函数

~~~ javascript
export default () => {
  //加载配置文件
  loadConfig('admin.jsonc', true)
  //注册事件
  event()
}

function event() {
  //一共有三种消息类型，会返回的类型如下
  RegEvent('notice', async context => {
    await notice(context)
  })
  RegEvent('request', async context => {
    await request(context)
  })
  RegEvent('message', async (event, context, tags) => {
    //事件触发内部会自动检查是否是命令
    if (context.command) {
      if (context.command.name === '入群') {
        await invite(context, context.command.params, 'invite')
      } else if (context.command.name === '加群') {
        await invite(context, context.command.params, 'add')
      } else if (context.command.name === '好友') {
        await friend(context, context.command.params)
      }
    }
  })
}
~~~
